{"version":3,"sources":["webpack:///src/components/cusOrder.vue","webpack:///./src/components/cusOrder.vue?5998","webpack:///./src/components/cusOrder.vue","webpack:///src/components/cusOrderList.vue","webpack:///./src/components/cusOrderList.vue?4bfe","webpack:///./src/components/cusOrderList.vue"],"names":["cusOrder","props","order","type","Object","default","name","data","fit","statusLabels","evaluationDialog","rateSubmit","computed","payButton","this","status","confirmButton","evaluationButton","time","Date","Number","startTime","toLocaleString","src","dishSrc","title","storeName","mounted","rate","methods","updateOrderRate","_this","$axios","post","then","res","$message","message","catch","e","error","toOrderInfo","$router","push","params","id","alipay","_this2","routerData","resolve","path","query","html","window","open","href","console","log","confirm","_this3","get","endTime","getTime","components_cusOrder","render","_vm","_h","$createElement","_c","_self","staticClass","_v","_s","staticStyle","width","height","attrs","preview-src-list","dishName","plain","on","click","$event","_e","visible","modal","update:visible","float","show-score","text-color","score-template","model","value","callback","$$v","$set","expression","rows","placeholder","slot","directives","rawName","staticRenderFns","cusOrderList","components","__webpack_require__","normalizeComponent","ssrContext","activeName","orders","curOrders","itemHeight","screenHeight","startOffset","start","end","scrollDebounce","created","debounce","scrollEvent","orderListHeight","length","visibleCount","Math","ceil","visibleData","slice","min","getTransform","getOrdersByCusId","document","body","clientHeight","fn","wait","timeout","_arguments","arguments","clearTimeout","setTimeout","apply","scrollTop","$refs","list","floor","handleClick","filter","item","customerId","sessionStorage","getItem","components_cusOrderList","tab-click","label","ref","scroll","style","transform","_l","key","cusOrderList_Component","cusOrderList_normalizeComponent","__webpack_exports__"],"mappings":"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","file":"static/js/4.8cbef5ef6c1f04da508d.js","sourcesContent":["<template>\r\n  <div>\r\n    <div class=\"order\">\r\n      <p class=\"order-storeName\">{{title}}</p>\r\n      <div class=\"order-dish\">\r\n        <el-image\r\n          style=\"width: 150px;height: 100px;\"\r\n          :src=\"order.dishSrc\"\r\n          :fit=\"fit\"\r\n          :preview-src-list=\"src\"></el-image>\r\n        <p class=\"order-dishName\">{{order.dishName}}</p>\r\n      </div>\r\n      <p class=\"order-time\">下单时间: {{time}}</p>\r\n      <div class=\"order-button-list\">\r\n        <el-button type=\"primary\" plain v-if=\"payButton\" @click=\"alipay()\">立即付款</el-button>\r\n        <el-button type=\"primary\" plain v-if=\"confirmButton\" @click=\"confirm()\">确认送达</el-button>\r\n        <el-button type=\"primary\" plain v-if=\"evaluationButton\" @click=\"evaluationDialog = true\">评价</el-button>\r\n        <el-button type=\"primary\" plain @click=\"toOrderInfo()\">详情</el-button>\r\n      </div>\r\n      <div class=\"order-status-contain\">\r\n        <span class=\"order-status\">{{statusLabels[order.status]}}</span>\r\n      </div>\r\n      <el-dialog\r\n        title=\"评价\"\r\n        :visible.sync=\"evaluationDialog\"\r\n        :modal=\"false\"\r\n        width=\"40%\">\r\n        <span style=\"float: left;\">评分:</span>\r\n        <el-rate\r\n          v-model=\"order.rate\"\r\n          show-score\r\n          text-color=\"#ff9900\"\r\n          score-template=\"{value}\">\r\n        </el-rate>\r\n        <el-input\r\n          type=\"textarea\"\r\n          :rows=\"3\"\r\n          placeholder=\"请输入内容\"\r\n          v-model=\"order.customerEvaluate\">\r\n        </el-input>\r\n        <span slot=\"footer\" class=\"dialog-footer\">\r\n          <el-button @click=\"evaluationDialog = false\">取消</el-button>\r\n          <el-button type=\"primary\" @click=\"updateOrderRate()\" v-show=\"evaluationDialog && rateSubmit\">提交</el-button>\r\n        </span>\r\n      </el-dialog>\r\n    </div>\r\n  </div>\r\n</template>\r\n<script>\r\nexport default {\r\n  props: {\r\n    order: {\r\n      type: Object,\r\n      default: () => {\r\n        return {}\r\n      }\r\n    }\r\n  },\r\n  name: '',\r\n  data () {\r\n    return {\r\n      fit: 'cover',\r\n      statusLabels: ['待付款', '未完成', '已完成'],\r\n      evaluationDialog: false,\r\n      rateSubmit: true // 评价提交后，不再允许重复提交\r\n    }\r\n  },\r\n  // created () {\r\n  //   this.websocket.onmessage = function (e) {\r\n  //     if (e.data === 'paid') {\r\n  //       console.log(this.order, 'cusorder')\r\n  //     }\r\n  //   }\r\n  // },\r\n  computed: {\r\n    payButton () {\r\n      return this.order.status === 0\r\n    },\r\n    confirmButton () {\r\n      return this.order.status === 1\r\n    },\r\n    evaluationButton () {\r\n      return this.order.status === 2\r\n    },\r\n    time () {\r\n      let date = new Date(Number(this.order.startTime))\r\n      return date.toLocaleString()\r\n    },\r\n    src () {\r\n      return [this.order.dishSrc]\r\n    },\r\n    title () {\r\n      return this.order.storeName ? this.order.storeName : 'NULL'\r\n    }\r\n  },\r\n  mounted () {\r\n    if (this.order.rate) {\r\n      this.rateSubmit = false\r\n    }\r\n  },\r\n  methods: {\r\n    updateOrderRate () {\r\n      this.$axios\r\n        .post('api/order/updateOrderRate', this.order)\r\n        .then(res => {\r\n          this.evaluationDialog = false\r\n          this.$message({\r\n            message: '提交成功',\r\n            type: 'success'\r\n          })\r\n        })\r\n        .catch(e => {\r\n          this.$message.error(e.status + ' ' + e.error)\r\n        })\r\n    },\r\n    toOrderInfo () {\r\n      this.$router.push({\r\n        name: 'orderInfo',\r\n        params: {\r\n          id: this.order.id\r\n        }\r\n      })\r\n    },\r\n    alipay () {\r\n      this.$axios\r\n        .post('api/pay/confirm', this.order)\r\n        .then(res => {\r\n          if (res.status === 200) {\r\n            let routerData = this.$router.resolve({\r\n              path: '/apply',\r\n              query: {\r\n                html: res.data\r\n              }\r\n            })\r\n            window.open(routerData.href, '_blank')\r\n          }\r\n          console.log(res)\r\n        })\r\n        .catch(e => {\r\n          this.$message.error(e.status + ' ' + e.error)\r\n        })\r\n    },\r\n    confirm () {\r\n      this.$axios\r\n        .get('/api/order/updateOrderStatusConfirm', {\r\n          params: {\r\n            id: this.order.id,\r\n            endTime: new Date().getTime()\r\n          }\r\n        })\r\n        .then(res => {\r\n          this.order.status = 2\r\n        })\r\n        .catch(e => {\r\n          this.$message.error(e.status + ' ' + e.error)\r\n        })\r\n    }\r\n  }\r\n}\r\n</script>\r\n<style scoped>\r\n.order {\r\n  margin: 20px 0px;\r\n  background:#F2F6FC;\r\n  width: 100%;\r\n  height: 250px;\r\n  position: relative;\r\n  overflow: hidden;\r\n}\r\n.order-storeName {\r\n  text-align: left;\r\n  margin: 0px 0px 0px 20px;\r\n  padding: 10px 0px;\r\n  font-weight: bold;\r\n  font-size: 26px;\r\n}\r\n.order-dish {\r\n  display: block;\r\n  width: 150px;\r\n  height: 120px;\r\n  margin-left: 20px;\r\n}\r\n.order-dishName {\r\n  margin: 0px 0px 10px 0px;\r\n  font-size: 14px;\r\n}\r\n.order-time {\r\n  color: #909399;\r\n  font-size: 14px;\r\n  text-align: left;\r\n  margin: 5px 20px;\r\n}\r\n.order-button-list {\r\n  float: right;\r\n  padding-right: 10px;\r\n}\r\n.order-status {\r\n  position: absolute;\r\n  left: 10px;\r\n  bottom: 20px;\r\n  transform: rotate(45deg);\r\n  color: red;\r\n  font-size: 12px;\r\n}\r\n.order-status-contain {\r\n  position: absolute;\r\n  top: -50px;\r\n  right: -50px;\r\n  width: 100px;\r\n  height: 100px;\r\n  border: 5px solid red;\r\n  border-radius: 50%;\r\n}\r\n.order /deep/ .el-rate {\r\n  float: left;\r\n  margin: 0px 0px 10px 5px;\r\n}\r\n</style>\r\n\n\n\n// WEBPACK FOOTER //\n// src/components/cusOrder.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('div',{staticClass:\"order\"},[_c('p',{staticClass:\"order-storeName\"},[_vm._v(_vm._s(_vm.title))]),_vm._v(\" \"),_c('div',{staticClass:\"order-dish\"},[_c('el-image',{staticStyle:{\"width\":\"150px\",\"height\":\"100px\"},attrs:{\"src\":_vm.order.dishSrc,\"fit\":_vm.fit,\"preview-src-list\":_vm.src}}),_vm._v(\" \"),_c('p',{staticClass:\"order-dishName\"},[_vm._v(_vm._s(_vm.order.dishName))])],1),_vm._v(\" \"),_c('p',{staticClass:\"order-time\"},[_vm._v(\"下单时间: \"+_vm._s(_vm.time))]),_vm._v(\" \"),_c('div',{staticClass:\"order-button-list\"},[(_vm.payButton)?_c('el-button',{attrs:{\"type\":\"primary\",\"plain\":\"\"},on:{\"click\":function($event){return _vm.alipay()}}},[_vm._v(\"立即付款\")]):_vm._e(),_vm._v(\" \"),(_vm.confirmButton)?_c('el-button',{attrs:{\"type\":\"primary\",\"plain\":\"\"},on:{\"click\":function($event){return _vm.confirm()}}},[_vm._v(\"确认送达\")]):_vm._e(),_vm._v(\" \"),(_vm.evaluationButton)?_c('el-button',{attrs:{\"type\":\"primary\",\"plain\":\"\"},on:{\"click\":function($event){_vm.evaluationDialog = true}}},[_vm._v(\"评价\")]):_vm._e(),_vm._v(\" \"),_c('el-button',{attrs:{\"type\":\"primary\",\"plain\":\"\"},on:{\"click\":function($event){return _vm.toOrderInfo()}}},[_vm._v(\"详情\")])],1),_vm._v(\" \"),_c('div',{staticClass:\"order-status-contain\"},[_c('span',{staticClass:\"order-status\"},[_vm._v(_vm._s(_vm.statusLabels[_vm.order.status]))])]),_vm._v(\" \"),_c('el-dialog',{attrs:{\"title\":\"评价\",\"visible\":_vm.evaluationDialog,\"modal\":false,\"width\":\"40%\"},on:{\"update:visible\":function($event){_vm.evaluationDialog=$event}}},[_c('span',{staticStyle:{\"float\":\"left\"}},[_vm._v(\"评分:\")]),_vm._v(\" \"),_c('el-rate',{attrs:{\"show-score\":\"\",\"text-color\":\"#ff9900\",\"score-template\":\"{value}\"},model:{value:(_vm.order.rate),callback:function ($$v) {_vm.$set(_vm.order, \"rate\", $$v)},expression:\"order.rate\"}}),_vm._v(\" \"),_c('el-input',{attrs:{\"type\":\"textarea\",\"rows\":3,\"placeholder\":\"请输入内容\"},model:{value:(_vm.order.customerEvaluate),callback:function ($$v) {_vm.$set(_vm.order, \"customerEvaluate\", $$v)},expression:\"order.customerEvaluate\"}}),_vm._v(\" \"),_c('span',{staticClass:\"dialog-footer\",attrs:{\"slot\":\"footer\"},slot:\"footer\"},[_c('el-button',{on:{\"click\":function($event){_vm.evaluationDialog = false}}},[_vm._v(\"取消\")]),_vm._v(\" \"),_c('el-button',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.evaluationDialog && _vm.rateSubmit),expression:\"evaluationDialog && rateSubmit\"}],attrs:{\"type\":\"primary\"},on:{\"click\":function($event){return _vm.updateOrderRate()}}},[_vm._v(\"提交\")])],1)],1)],1)])}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-3bcfe1eb\",\"hasScoped\":true,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/components/cusOrder.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true,\\\"publicPath\\\":\\\"../../\\\"}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-3bcfe1eb\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!../../node_modules/vue-loader/lib/selector?type=styles&index=0!./cusOrder.vue\")\n}\nvar normalizeComponent = require(\"!../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../node_modules/vue-loader/lib/selector?type=script&index=0!./cusOrder.vue\"\nimport __vue_script__ from \"!!babel-loader!../../node_modules/vue-loader/lib/selector?type=script&index=0!./cusOrder.vue\"\n/* template */\nimport __vue_template__ from \"!!../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-3bcfe1eb\\\",\\\"hasScoped\\\":true,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../node_modules/vue-loader/lib/selector?type=template&index=0!./cusOrder.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-3bcfe1eb\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/cusOrder.vue\n// module id = null\n// module chunks = ","<template>\r\n  <div>\r\n    <el-tabs v-model=\"activeName\" @tab-click=\"handleClick\" class=\"cus-taps\">\r\n      <el-tab-pane label=\"待付款\" name=\"noPay\"></el-tab-pane>\r\n      <el-tab-pane label=\"未完成\" name=\"noDone\"></el-tab-pane>\r\n      <el-tab-pane label=\"已完成\" name=\"Done\"></el-tab-pane>\r\n      <el-tab-pane label=\"全部订单\" name=\"All\"></el-tab-pane>\r\n    </el-tabs>\r\n    <div ref=\"list\" class=\"orderList-contain\" @scroll=\"scrollDebounce()\">\r\n      <div class=\"infinite-list-phantom\" :style=\"{ height: orderListHeight + 'px' }\"></div>\r\n      <div class=\"infinite-list\" :style=\"{ transform: getTransform }\">\r\n        <cus-order\r\n          class=\"orderList\"\r\n          v-for=\"order in visibleData\"\r\n          :key=\"order.id\"\r\n          :order=\"order\"></cus-order>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n<script>\r\nimport cusOrder from './cusOrder'\r\nexport default {\r\n  components: {\r\n    cusOrder\r\n  },\r\n  data () {\r\n    return {\r\n      activeName: 'All',\r\n      orders: [],\r\n      curOrders: [],\r\n      itemHeight: 100,\r\n      screenHeight: 0,\r\n      startOffset: 0,\r\n      start: 0,\r\n      end: null,\r\n      scrollDebounce: () => {}\r\n    }\r\n  },\r\n  created () {\r\n    this.scrollDebounce = this.debounce(this.scrollEvent, 100)\r\n  },\r\n  computed: {\r\n    orderListHeight () {\r\n      return this.curOrders.length * this.itemHeight\r\n    },\r\n    visibleCount () {\r\n      return Math.ceil(this.screenHeight / this.itemHeight)\r\n    },\r\n    visibleData () {\r\n      return this.curOrders.slice(this.start, Math.min(this.end, this.curOrders.length))\r\n    },\r\n    getTransform () {\r\n      return `translate3d(0, ${this.startOffset}px,0)`\r\n    }\r\n  },\r\n  mounted () {\r\n    this.getOrdersByCusId()\r\n    this.screenHeight = 550\r\n    console.log(this.screenHeight, document.body.clientHeight)\r\n    this.end = this.start + this.visibleCount\r\n  },\r\n  methods: {\r\n    debounce (fn, wait) {\r\n      let timeout = null\r\n      return function () {\r\n        if (timeout) clearTimeout(timeout)\r\n        timeout = setTimeout(() => {\r\n          fn.apply(this, arguments)\r\n        }, wait)\r\n      }\r\n    },\r\n    scrollEvent (e) {\r\n      let scrollTop = this.$refs.list.scrollTop\r\n      console.log(scrollTop)\r\n      this.start = Math.floor(scrollTop / this.itemHeight)\r\n      this.end = this.start + this.visibleCount\r\n      this.startOffset = scrollTop - (scrollTop % this.itemHeight)\r\n    },\r\n    handleClick () {\r\n      if (this.activeName === 'noPay') {\r\n        this.curOrders = this.orders.filter(item => item.status === 0)\r\n      } else if (this.activeName === 'noDone') {\r\n        this.curOrders = this.orders.filter(item => item.status === 1)\r\n      } else if (this.activeName === 'Done') {\r\n        this.curOrders = this.orders.filter(item => item.status === 2)\r\n      } else {\r\n        this.curOrders = this.orders.filter(item => item.status >= 0)\r\n      }\r\n    },\r\n    getOrdersByCusId () {\r\n      this.$axios\r\n        .get('api/order/getOrderByCustomerId', {\r\n          params: {\r\n            customerId: sessionStorage.getItem('userId')\r\n          }\r\n        })\r\n        .then(res => {\r\n          this.orders = res.data\r\n          this.curOrders = res.data\r\n        })\r\n        .catch(e => {\r\n          this.$message.error(e.status + ' ' + e.error)\r\n        })\r\n    }\r\n  }\r\n}\r\n</script>\r\n<style scoped>\r\n.cus-taps {\r\n  margin-top: 100px;\r\n}\r\n.orderList {\r\n  width: 47%;\r\n}\r\n.orderList-contain {\r\n  height: 550px;\r\n  overflow: auto;\r\n  position: relative;\r\n}\r\n.infinite-list-phantom {\r\n  position: absolute;\r\n  left: 0;\r\n  top: 0;\r\n  right: 0;\r\n  z-index: -1;\r\n}\r\n.infinite-list {\r\n  display: flex;\r\n  flex-wrap: wrap;\r\n  justify-content: space-between;\r\n  left: 0;\r\n  right: 0;\r\n  top: 0;\r\n  position: absolute;\r\n  width: 100%;\r\n}\r\n\r\n</style>\r\n\n\n\n// WEBPACK FOOTER //\n// src/components/cusOrderList.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('el-tabs',{staticClass:\"cus-taps\",on:{\"tab-click\":_vm.handleClick},model:{value:(_vm.activeName),callback:function ($$v) {_vm.activeName=$$v},expression:\"activeName\"}},[_c('el-tab-pane',{attrs:{\"label\":\"待付款\",\"name\":\"noPay\"}}),_vm._v(\" \"),_c('el-tab-pane',{attrs:{\"label\":\"未完成\",\"name\":\"noDone\"}}),_vm._v(\" \"),_c('el-tab-pane',{attrs:{\"label\":\"已完成\",\"name\":\"Done\"}}),_vm._v(\" \"),_c('el-tab-pane',{attrs:{\"label\":\"全部订单\",\"name\":\"All\"}})],1),_vm._v(\" \"),_c('div',{ref:\"list\",staticClass:\"orderList-contain\",on:{\"scroll\":function($event){return _vm.scrollDebounce()}}},[_c('div',{staticClass:\"infinite-list-phantom\",style:({ height: _vm.orderListHeight + 'px' })}),_vm._v(\" \"),_c('div',{staticClass:\"infinite-list\",style:({ transform: _vm.getTransform })},_vm._l((_vm.visibleData),function(order){return _c('cus-order',{key:order.id,staticClass:\"orderList\",attrs:{\"order\":order}})}),1)])],1)}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-3dc4c625\",\"hasScoped\":true,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/components/cusOrderList.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true,\\\"publicPath\\\":\\\"../../\\\"}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-3dc4c625\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!../../node_modules/vue-loader/lib/selector?type=styles&index=0!./cusOrderList.vue\")\n}\nvar normalizeComponent = require(\"!../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../node_modules/vue-loader/lib/selector?type=script&index=0!./cusOrderList.vue\"\nimport __vue_script__ from \"!!babel-loader!../../node_modules/vue-loader/lib/selector?type=script&index=0!./cusOrderList.vue\"\n/* template */\nimport __vue_template__ from \"!!../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-3dc4c625\\\",\\\"hasScoped\\\":true,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../node_modules/vue-loader/lib/selector?type=template&index=0!./cusOrderList.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-3dc4c625\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/cusOrderList.vue\n// module id = null\n// module chunks = "],"sourceRoot":""}