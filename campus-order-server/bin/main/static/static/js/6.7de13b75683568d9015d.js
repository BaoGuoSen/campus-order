webpackJsonp([6],{P0zn:function(t,e){},oSZb:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=s("zH3v"),i=s("vMJZ"),o={components:{mymap:r.a},data:function(){return{mapShow:!1,isEdit:!1,drawer:!1,store:"",user:{id:"",userName:"",type:"",location:"",lng:"",lat:""},wsUrl:"ws://127.0.0.1:8080/ws/"}},computed:{role:function(){return"1"===this.user.type?"商家":"2"===this.user.type?"骑手":"3"===this.user.type?"顾客":void 0},title:function(){return this.mapShow?"高德地图":"cusOrderList"===this.$route.name?"我的订单":"orderInfo"===this.$route.name?"订单详情":"美食广场"}},created:function(){this.userinit(),this.wsUrl=this.wsUrl+this.user.id,this.socket.initWebSocket(this.wsUrl),this.websocketSend(this.user.userName)},mounted:function(){},methods:{toHome:function(){this.mapShow&&(this.mapShow=!this.mapShow),this.$router.push({path:"/customer/allDishs",query:{}})},toOrder:function(){this.$router.push({path:"/customer/cusOrderList",query:{}})},addressControl:function(t,e,s){this.mapShow=!this.mapShow,t&&(this.user.location=t,this.user.lng=e,this.user.lat=s,sessionStorage.setItem("userLocation",t),this.updateUser())},drawerClose:function(){this.drawer=!1,this.isEdit=!1},userinit:function(){this.user.id=sessionStorage.getItem("userId"),this.user.userName=sessionStorage.getItem("userName"),this.user.type=sessionStorage.getItem("userType"),this.user.location=sessionStorage.getItem("userLocation"),this.user.lng=sessionStorage.getItem("lng"),this.user.lat=sessionStorage.getItem("lat")},drawerInit:function(){this.drawer=!1,this.isEdit=!1},toStoreInfo:function(){this.$router.push({path:"/storeInfo"})},logout:function(){console.log("logout"),sessionStorage.clear(),this.$router.push({path:"/"})},updateUser:function(){var t=this;Object(i.a)(this.user).then(function(e){t.$message({message:"修改成功",type:"success"}),t.isEdit=!t.isEdit,t.drawer=!1}).catch(function(e){t.$message.error(e.status+" "+e.error)})},onmessage:function(t){t&&console.log(t,"支付成功的订单id")},websocketSend:function(t){this.socket.sendSock(t,this.onmessage)}},destroyed:function(){this.socket.webSocketClose()}},n={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"wrapper1"},[s("div",{staticClass:"header"},[s("div",{staticClass:"title"},[s("h1",{staticStyle:{display:"inline-block"}},[t._v(t._s(t.title))]),t._v(" "),s("el-tooltip",{attrs:{content:"美食广场",placement:"right-end",effect:"light"}},[s("i",{staticClass:"el-icon-s-home",on:{click:function(e){return t.toHome()}}})])],1),t._v(" "),s("div",{staticClass:"right"},[s("el-dropdown",{attrs:{trigger:"click"}},[s("el-avatar",{staticStyle:{cursor:"pointer"},attrs:{size:35,src:"https://cube.elemecdn.com/0/88/03b0d39583f48206768a7534e55bcpng.png"}}),t._v(" "),s("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[s("el-dropdown-item",{nativeOn:{click:function(e){t.drawer=!0}}},[t._v("个人信息")]),t._v(" "),s("el-dropdown-item",{nativeOn:{click:function(e){return t.toOrder()}}},[t._v("我的订单")]),t._v(" "),s("el-dropdown-item",{nativeOn:{click:function(e){return t.addressControl()}}},[t._v("重新定位")]),t._v(" "),s("el-dropdown-item",{nativeOn:{click:function(e){return t.logout()}}},[t._v("退出登录")])],1)],1)],1)]),t._v(" "),s("el-drawer",{ref:"drawer",attrs:{title:"个人信息",visible:t.drawer,direction:"rtl","before-close":t.drawerClose,"custom-class":"demo-drawer"},on:{"update:visible":function(e){t.drawer=e}}},[s("div",[s("el-form",{staticStyle:{margin:"25px"},attrs:{model:t.user,"label-width":"100px"}},[s("el-form-item",{attrs:{label:"用户Id："}},[s("el-input",{attrs:{disabled:""},model:{value:t.user.id,callback:function(e){t.$set(t.user,"id",e)},expression:"user.id"}})],1),t._v(" "),s("el-form-item",{attrs:{label:"用户名："}},[s("el-input",{attrs:{disabled:!1===t.isEdit},model:{value:t.user.userName,callback:function(e){t.$set(t.user,"userName",e)},expression:"user.userName"}})],1),t._v(" "),s("el-form-item",{attrs:{label:"角色："}},[s("el-input",{attrs:{disabled:""},model:{value:t.role,callback:function(e){t.role=e},expression:"role"}})],1),t._v(" "),s("el-form-item",{attrs:{label:"地址信息："}},[s("el-input",{attrs:{disabled:!1===t.isEdit},model:{value:t.user.location,callback:function(e){t.$set(t.user,"location",e)},expression:"user.location"}})],1)],1),t._v(" "),s("div",{staticClass:"demo-drawer__footer"},[s("el-button",{on:{click:t.drawerInit}},[t._v("取 消")]),t._v(" "),t.isEdit?s("el-button",{attrs:{type:"primary"},on:{click:t.updateUser}},[t._v("提交")]):s("el-button",{attrs:{type:"primary"},on:{click:function(e){t.isEdit=!t.isEdit}}},[t._v("修改")])],1)],1)]),t._v(" "),s("div",{staticClass:"content"},[t.mapShow?t._e():s("router-view")],1),t._v(" "),s("keep-alive",[t.mapShow?s("mymap",{staticClass:"map",on:{addressControl:t.addressControl}}):t._e()],1)],1)},staticRenderFns:[]};var a=s("VU/8")(o,n,!1,function(t){s("P0zn")},"data-v-4cf4089b",null);e.default=a.exports},vMJZ:function(t,e,s){"use strict";s.d(e,"a",function(){return o});var r=s("mtWM"),i=s.n(r),o=function(t){return i.a.post("api/user/update",t)}}});
//# sourceMappingURL=6.7de13b75683568d9015d.js.map